<!DOCTYPE html>
<html>
	<head>
        <title>Yew Zi Hon | Final Project</title>
        <link rel="stylesheet" type="text/css" href="styles/style.css"/>
        <link rel="preconnect" href="https://fonts.gstatic.com"><!-- adding google fonts-->
        <link href="https://fonts.googleapis.com/css2?family=Josefin+Slab&family=Rubik:wght@300&display=swap" rel="stylesheet">
        <link href="styles/fontawesome/css/all.css" rel="stylesheet">
        <meta name="viewport" content="width=device-width,2 initial-scale=1.0">
	</head>
    <script>
    
    
    </script>
	<body>
        <div id="container">
            <div id= "header">
                <h1>Final Project</h1>
            </div>
            <div>
                <input type="checkbox" id="btn" hidden>
                <label for="btn" id="icon">
                <i class="fas fa-3x fa-bars" style="padding-left:3px;padding-top:1px;"></i></label>
                <nav id="nav">
                    <ul id="navlinks">
                        <li class="firstLink"><a href="index.html"><h1> Home</h1></a><br></li>
                        <li><a href="about.html"><h1> About</h1></a><br></li>
                        <li><a href="elecProd.html"><h1> Electronics Production</h1></a><br></li>
                        <li><a href="elecDes.html"><h1> Electronics Design</h1></a><br></li>
                        <li><a href="2Dcnc.html"><h1>2D CNC</h1></a><br></li>
                        <li><a href="embProg.html"><h1> Embedded Programming</h1></a><br></li>
                        <li><a href="3Dcnc.html"><h1> 3D CNC</h1></a><br></li>
                        <li><a href="moldCast.html"><h1 class="currentLink"> Molding and Casting</h1></a><br></li>
                        <li><a href="interface.html"><h1> Interface and applications programming</h1></a><br></li>
                        <li><a href="finalPro.html"><h1> Final Project</h1></a><br></li>
                    </ul>
                </nav>
             </div>
            <div id="content">
                
                <div id="main"><br><br>
                    <h1>Final project.</h1><br>
                    <p>
                        Here lies thy documentation for the final project, the Jukebox.
                    </p>
                    <ul>
                        <li><a href="#idea">Ideation</a></li>
                        <li><a href="#smf">Midi file format</a></li>
                            <ul style="padding-left: 3vw">
                                <li><a href=#time>Midi timings</a></li>
                                <li><a href=#cmd>Midi commands</a></li>
                                <li><a href=#notes>Midi notes</a></li>
                            </ul>
                        <li><a href="#cad">Cad Design</a></li>
                        <li><a href="#moldncast">Molding and casting</a></li>
                            <ul style="padding-left: 3vw">
                                <li><a href=#mill>CNC milling</a></li>
                                <li><a href=#mold>Molding</a></li>
                                <li><a href=#cast>Casting</a></li>
                            </ul>
                        <li><a href="#cncm">CNC milling</a></li>
                        <li><a href="#3dp">3D printing</a></li>
                        <li><a href="#laser">Laser cutting</a></li>
                        <li><a href="#pcbd">Pcb design</a></li>
                            <ul style="padding-left: 3vw">
                                <li><a href=#srd>Shift register board design</a></li>
                                <li><a href=#mcud>Microcontroller board design</a></li>
                                <li><a href=#srm>Shift register board milling</a></li>
                                <li><a href=#mcum>Microcontroller board milling</a></li>
                            </ul>
                        <li><a href="#prgm">Programming</a></li>
                            <ul style="padding-left: 3vw">
                                <li><a href=#renc>Rotory encoder programming</a></li>
                                <li><a href=#lcd>LCD programming</a></li>
                                <li><a href=#sd>SD card programming</a></li>
                                <li><a href=#menunav>Menu navigation</a></li>
                                <li><a href=#mdmidi>Midi file processing</a></li>
                                <li><a href=#asmsynth>Assembly triangle wave generator</a></li>
                                <li><a href=#uart>UART buffering</a></li>
                                <li><a href=#adsr>ADSR envelope</a></li>
                                <li><a href=#sr>Shift register programming</a></li>
                                <li><a href=#tmr1>Servo timer interrupts</a></li>
                                <li><a href=#bootl>Bootloader burn</a></li>
                                <li><a href=#src>Source files</a></li>
                            </ul>
                        <li><a href="#slide">Slide</a></li>
                        <li><a href="#video">Video</a></li>
                        <li><a href="#test">Testing</a></li>
                            <ul style="padding-left: 3vw">
                                <li><a href=#mcAlpha>Minecraft Volume Alpha</a></li>
                                    <ul style="padding-left: 3vw">
                                        <li><a href=#calm>Calm</a></li>
                                        <li><a href=#key>Key</a></li>
                                        <li><a href=#living_mice>Living Mice</a></li>
                                        <li><a href=#sweden>Sweden</a></li>
                                    </ul>
                                <li><a href=#mcBeta>Minecraft Volume Beta</a></li>
                                    <ul style="padding-left: 3vw">
                                        <li><a href=#mall>Mall</a></li>
                                        <li><a href=#mellohi>Mellohi</a></li>
                                        <li><a href=#wait>Wait</a></li>
                                    </ul>
                                <li><a href=#undertale>Undertale</a></li>
                                    <ul style="padding-left: 3vw">
                                        <li><a href=#home>Home</a></li>
                                        <li><a href=#ouat>Once Upon A Time</a></li>
                                        <li><a href=#undertaleUndertale>Undertale</a></li>
                                    </ul>
                                <li><a href=#hello_world>Hello World</a></li>
                                <li><a href=#eight_melodies>Eight melodies</a></li>
                            </ul>
                        <li><a href="#FIN">Finished</a></li>
                    </ul>
                    
                    <br><hr><br>
                    
                    <h3 id="idea">Ideation</h3><br>
                    <p>This project is inspired by self playing pianos.</p>
                    <p>Player piano from wikipedia:</p><video autoplay muted loop width=100%><source src="https://upload.wikimedia.org/wikipedia/commons/transcoded/0/02/Steinway_piano_-_Duo-Art.ogv/Steinway_piano_-_Duo-Art.ogv.480p.vp9.webm" type="video/webm"></video>
                    <p>A melodica is a small piano with fewer keys.</p><img src="https://upload.wikimedia.org/wikipedia/commons/c/cf/Melodica.jpg?20050527142810">
                    <p>Melodica played using midi.</p>
                    <iframe width=100% height=760px src="https://www.youtube.com/embed/JEMaoc9eZx4" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><br><hr><br>
                    <br><hr><br>
                    
                    <h3 id="smf">Midi file format</h3><br>
                        <h4 id="time">Midi timings</h4>
                        <p>A midi event will have the change in time from the previous event and the event data.</p><img src="Assets0/finalpro/midi/timing/5.JPG">
                        <p>Example midi data in hexadecimal.</p><img src="Assets0/finalpro/midi/timing/6.JPG">
                        <p>Delta time is calculated from the tempo and time signature of the midi track.</p><img src="Assets0/finalpro/midi/timing/7.JPG">
                        <a href="https://www.cs.cmu.edu/~music/cmsip/readings/Standard-MIDI-file-format-updated.pdf">Source</a>
                    <br><hr><br>
                        <h4 id="cmd">Midi commands</h4>
                        <p>Midi event flow.</p><img src="Assets0/finalpro/midi/cmd/1.JPG">
                        <p>Midi message structure.</p><img src="Assets0/finalpro/midi/cmd/2.JPG">
                        <p>Midi commands and their hex codes. Only note on and note off commands will be processed. Other commands are ignored.</p><img src="Assets0/finalpro/midi/cmd/3.JPG">
                        <p>A midi command also includes the note and velocity. The velocity is ignored and only the note and channel is used.</p><img src="Assets0/finalpro/midi/cmd/4.JPG">
                        <a href="http://www.shclemen.com/download/The%20Complete%20MIDI1.0%20Detailed%20Spec.pdf">Source</a>
                    <br><hr><br>
                        <h4 id="notes">Midi notes</h4>
                        <p>128 midi notes and their corresponding keys. 
                        <a href="https://www.inspiredacoustics.com/en/MIDI_note_numbers_and_center_frequencies">Source</a></p>
                        <table>
                            <thead>
                            <tr>
                            <th><strong>MIDI note number</strong></th>
                            <th><strong>Key number (Organ)</strong></th>
                            <th><strong>Key number (Piano)</strong></th>
                            <th><strong>Note names (English)</strong></th>
                            <th><strong>Note names (German)</strong></th>
                            <th><strong>Frequency (Equal tuning at 440 Hz)</strong></th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                            <td>top of MIDI tuning range</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>G#9/Ab9</td>
                            <td>gis’’’’’’/ges’’’’’’</td>
                            <td>13289.75</td>
                            </tr>
                            <tr>
                            <td>127</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>G9</td>
                            <td>g’’’’’’</td>
                            <td>12543.85</td>
                            </tr>
                            <tr>
                            <td>126</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>F#9/Gb9</td>
                            <td>fis’’’’’’/ges’’’’’’</td>
                            <td>11839.82</td>
                            </tr>
                            <tr>
                            <td>125</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>F9</td>
                            <td>f’’’’’’</td>
                            <td>11175.30</td>
                            </tr>
                            <tr>
                            <td>124</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>E9</td>
                            <td>e’’’’’’</td>
                            <td>10548.08</td>
                            </tr>
                            <tr>
                            <td>123</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>D#9/Eb9</td>
                            <td>dis’’’’’’/es’’’’’’</td>
                            <td>9956.06</td>
                            </tr>
                            <tr>
                            <td>122</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>D9</td>
                            <td>d’’’’’’</td>
                            <td>9397.27</td>
                            </tr>
                            <tr>
                            <td>121</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>C#9/Db9</td>
                            <td>cis’’’’’’/des’’’’’’</td>
                            <td>8869.84</td>
                            </tr>
                            <tr>
                            <td>120</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>C9</td>
                            <td>c’’’’’’</td>
                            <td>8372.02</td>
                            </tr>
                            <tr>
                            <td>119</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>B8</td>
                            <td>h’’’’’</td>
                            <td>7902.13</td>
                            </tr>
                            <tr>
                            <td>118</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>A#8/Bb8</td>
                            <td>ais’’’’’/b’’’’’</td>
                            <td>7458.62</td>
                            </tr>
                            <tr>
                            <td>117</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>A8</td>
                            <td>a’’’’’</td>
                            <td>7040.00</td>
                            </tr>
                            <tr>
                            <td>116</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>G#8/Ab8</td>
                            <td>gis’’’’’/ges’’’’’</td>
                            <td>6644.88</td>
                            </tr>
                            <tr>
                            <td>115</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>G8</td>
                            <td>g’’’’’</td>
                            <td>6271.93</td>
                            </tr>
                            <tr>
                            <td>114</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>F#8/Gb8</td>
                            <td>fis’’’’’/ges’’’’’</td>
                            <td>5919.91</td>
                             </tr>
                            <tr>
                            <td>113</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>F8</td>
                            <td>f’’’’’</td>
                            <td>5587.65</td>
                            </tr>
                            <tr>
                            <td>112</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>E8</td>
                            <td>e’’’’’</td>
                            <td>5274.04</td>
                            </tr>
                            <tr>
                            <td>111</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>D#8/Eb8</td>
                            <td>dis’’’’’/es’’’’’</td>
                            <td>4978.03</td>
                            </tr>
                            <tr>
                            <td>110</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>D8</td>
                            <td>d’’’’’</td>
                            <td>4698.64</td>
                            </tr>
                            <tr>
                            <td>109</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>C#8/Db8</td>
                            <td>cis’’’’’/des’’’’’</td>
                            <td>4434.92</td>
                            </tr>
                            <tr>
                            <td>108</td>
                            <td>&nbsp;</td>
                            <td>88</td>
                            <td>C8</td>
                            <td>c’’’’’</td>
                            <td>4186.01</td>
                            </tr>
                            <tr>
                            <td>107</td>
                            <td>&nbsp;</td>
                            <td>87</td>
                            <td>B7</td>
                            <td>h’’’’</td>
                            <td>3951.07</td>
                            </tr>
                            <tr>
                            <td>106</td>
                            <td>&nbsp;</td>
                            <td>86</td>
                            <td>A#7/Bb7</td>
                            <td>ais’’’’/b’’’’</td>
                            <td>3729.31</td>
                            </tr>
                            <tr>
                            <td>105</td>
                            <td>&nbsp;</td>
                            <td>85</td>
                            <td>A7</td>
                            <td>a’’’’</td>
                            <td>3520.00</td>
                            </tr>
                            <tr>
                            <td>104</td>
                            <td>&nbsp;</td>
                            <td>84</td>
                            <td>G#7/Ab7</td>
                            <td>gis’’’’/ges’’’’</td>
                            <td>3322.44</td>
                            </tr>
                            <tr>
                            <td>103</td>
                            <td>&nbsp;</td>
                            <td>83</td>
                            <td>G7</td>
                            <td>g’’’’</td>
                            <td>3135.96</td>
                            </tr>
                            <tr>
                            <td>102</td>
                            <td>&nbsp;</td>
                            <td>82</td>
                            <td>F#7/Gb7</td>
                            <td>fis’’’’/ges’’’’</td>
                            <td>2959.96</td>
                            </tr>
                            <tr>
                            <td>101</td>
                            <td>&nbsp;</td>
                            <td>81</td>
                            <td>F7</td>
                            <td>f’’’’</td>
                            <td>2793.83</td>
                            </tr>
                            <tr>
                            <td>100</td>
                            <td>&nbsp;</td>
                            <td>80</td>
                            <td>E7</td>
                            <td>e’’’’</td>
                            <td>2637.02</td>
                            </tr>
                            <tr>
                            <td>99</td>
                            <td>&nbsp;</td>
                            <td>79</td>
                            <td>D#7/Eb7</td>
                            <td>dis’’’’/es’’’’</td>
                            <td>2489.02</td>
                            </tr>
                            <tr>
                            <td>98</td>
                            <td>&nbsp;</td>
                            <td>78</td>
                            <td>D7</td>
                            <td>d’’’’</td>
                            <td>2349.32</td>
                            </tr>
                            <tr>
                            <td>97</td>
                            <td>&nbsp;</td>
                            <td>77</td>
                            <td>C#7/Db7</td>
                            <td>cis’’’’/des’’’’</td>
                            <td>2217.46</td>
                            </tr>
                            <tr>
                            <td>96</td>
                            <td>61</td>
                            <td>76</td>
                            <td>C7</td>
                            <td>c’’’’</td>
                            <td>2093.00</td>
                            </tr>
                            <tr>
                            <td>95</td>
                            <td>60</td>
                            <td>75</td>
                            <td>B6</td>
                            <td>h’’’</td>
                            <td>1975.53</td>
                            </tr>
                            <tr>
                            <td>94</td>
                            <td>59</td>
                            <td>74</td>
                            <td>A#6/Bb6</td>
                            <td>ais’’’/b’’’</td>
                            <td>1864.66</td>
                            </tr>
                            <tr>
                            <td>93</td>
                            <td>58</td>
                            <td>73</td>
                            <td>A6</td>
                            <td>a’’’</td>
                            <td>1760.00</td>
                            </tr>
                            <tr>
                            <td>92</td>
                            <td>57</td>
                            <td>72</td>
                            <td>G#6/Ab6</td>
                            <td>gis’’’/as’’’</td>
                            <td>1661.22</td>
                            </tr>
                            <tr>
                            <td>91</td>
                            <td>56</td>
                            <td>71</td>
                            <td>G6</td>
                            <td>g’’’</td>
                            <td>1567.98</td>
                            </tr>
                            <tr>
                            <td>90</td>
                            <td>55</td>
                            <td>70</td>
                            <td>F#6/Gb6</td>
                            <td>fis’’’/ges’’’</td>
                            <td>1479.98</td>
                            </tr>
                            <tr>
                            <td>89</td>
                            <td>54</td>
                            <td>69</td>
                            <td>F6</td>
                            <td>f’’’</td>
                            <td>1396.91</td>
                            </tr>
                            <tr>
                            <td>88</td>
                            <td>53</td>
                            <td>68</td>
                            <td>E6</td>
                            <td>e’’’</td>
                            <td>1318.51</td>
                            </tr>
                            <tr>
                            <td>87</td>
                            <td>52</td>
                            <td>67</td>
                            <td>D#6/Eb6</td>
                            <td>dis’’’/es’’’</td>
                            <td>1244.51</td>
                            </tr>
                            <tr>
                            <td>86</td>
                            <td>51</td>
                            <td>66</td>
                            <td>D6</td>
                            <td>d’’’</td>
                            <td>1174.66</td>
                            </tr>
                            <tr>
                            <td>85</td>
                            <td>50</td>
                            <td>65</td>
                            <td>C#6/Db6</td>
                            <td>cis’’’/des’’’</td>
                            <td>1108.73</td>
                            </tr>
                            <tr>
                            <td>84</td>
                            <td>49</td>
                            <td>64</td>
                            <td>C6</td>
                            <td>c’’’</td>
                            <td>1046.50</td>
                            </tr>
                            <tr>
                            <td>83</td>
                            <td>48</td>
                            <td>63</td>
                            <td>B5</td>
                            <td>h’’</td>
                            <td>987.77</td>
                            </tr>
                            <tr>
                            <td>82</td>
                            <td>47</td>
                            <td>62</td>
                            <td>A#5/Bb5</td>
                            <td>ais’’/b’’</td>
                            <td>932.33</td>
                            </tr>
                            <tr>
                            <td>81</td>
                            <td>46</td>
                            <td>61</td>
                            <td>A5</td>
                            <td>a’’</td>
                            <td>880.00</td>
                            </tr>
                            <tr>
                            <td>80</td>
                            <td>45</td>
                            <td>60</td>
                            <td>G#5/Ab5</td>
                            <td>gis’’/as’’</td>
                            <td>830.61</td>
                            </tr>
                            <tr>
                            <td>79</td>
                            <td>44</td>
                            <td>59</td>
                            <td>G5</td>
                            <td>g’’</td>
                            <td>783.99</td>
                            </tr>
                            <tr>
                            <td>78</td>
                            <td>43</td>
                            <td>58</td>
                            <td>F#5/Gb5</td>
                            <td>fis’’/ges’’</td>
                            <td>739.99</td>
                            </tr>
                            <tr>
                            <td>77</td>
                            <td>42</td>
                            <td>57</td>
                            <td>F5</td>
                            <td>f’’</td>
                            <td>698.46</td>
                            </tr>
                            <tr>
                            <td>76</td>
                            <td>41</td>
                            <td>56</td>
                            <td>E5</td>
                            <td>e’’</td>
                            <td>659.26</td>
                            </tr>
                            <tr>
                            <td>75</td>
                            <td>40</td>
                            <td>55</td>
                            <td>D#5/Eb5</td>
                            <td>dis’’/es’’</td>
                            <td>622.25</td>
                            </tr>
                            <tr>
                            <td>74</td>
                            <td>39</td>
                            <td>54</td>
                            <td>D5</td>
                            <td>d’’</td>
                            <td>587.33</td>
                            </tr>
                            <tr>
                            <td>73</td>
                            <td>38</td>
                            <td>53</td>
                            <td>C#5/Db5</td>
                            <td>cis’’/des’’</td>
                            <td>554.37</td>
                            </tr>
                            <tr>
                            <td>72</td>
                            <td>37</td>
                            <td>52</td>
                            <td>C5</td>
                            <td>c’’</td>
                            <td>523.25</td>
                            </tr>
                            <tr>
                            <td>71</td>
                            <td>36</td>
                            <td>51</td>
                            <td>B4</td>
                            <td>h’</td>
                            <td>493.88</td>
                            </tr>
                            <tr>
                            <td>70</td>
                            <td>35</td>
                            <td>50</td>
                            <td>A#4/Bb4</td>
                            <td>ais’/b’</td>
                            <td>466.16</td>
                            </tr>
                            <tr>
                            <td>69</td>
                            <td>34</td>
                            <td>49</td>
                            <td>A4 concert pitch</td>
                            <td>a’ Kammerton</td>
                            <td>440.00</td>
                            </tr>
                            <tr>
                            <td>68</td>
                            <td>33</td>
                            <td>48</td>
                            <td>G#4/Ab4</td>
                            <td>gis’/as’</td>
                            <td>415.30</td>
                            </tr>
                            <tr>
                            <td>67</td>
                            <td>32</td>
                            <td>47</td>
                            <td>G4</td>
                            <td>g’</td>
                            <td>392.00</td>
                            </tr>
                            <tr>
                            <td>66</td>
                            <td>31</td>
                            <td>46</td>
                            <td>F#4/Gb4</td>
                            <td>fis’/ges’</td>
                            <td>369.99</td>
                            </tr>
                            <tr>
                            <td>65</td>
                            <td>30</td>
                            <td>45</td>
                            <td>F4</td>
                            <td>f’</td>
                            <td>349.23</td>
                            </tr>
                            <tr>
                            <td>64</td>
                            <td>29</td>
                            <td>44</td>
                            <td>E4</td>
                            <td>e’</td>
                            <td>329.63</td>
                            </tr>
                            <tr>
                            <td>63</td>
                            <td>28</td>
                            <td>43</td>
                            <td>D#4/Eb4</td>
                            <td>dis’/es’</td>
                            <td>311.13</td>
                            </tr>
                            <tr>
                            <td>62</td>
                            <td>27</td>
                            <td>42</td>
                            <td>D4</td>
                            <td>d’</td>
                            <td>293.66</td>
                            </tr>
                            <tr>
                            <td>61</td>
                            <td>26</td>
                            <td>41</td>
                            <td>C#4/Db4</td>
                            <td>cis’/des’</td>
                            <td>277.18</td>
                            </tr>
                            <tr>
                            <td>60</td>
                            <td>25</td>
                            <td>40</td>
                            <td>C4 (middle C)</td>
                            <td>c’ (Schloss-C)</td>
                            <td>261.63</td>
                            </tr>
                            <tr>
                            <td>59</td>
                            <td>24</td>
                            <td>39</td>
                            <td>B3</td>
                            <td>h</td>
                            <td>246.94</td>
                            </tr>
                            <tr>
                            <td>58</td>
                            <td>23</td>
                            <td>38</td>
                            <td>A#3/Bb3</td>
                            <td>ais/b</td>
                            <td>233.08</td>
                            </tr>
                            <tr>
                            <td>57</td>
                            <td>22</td>
                            <td>37</td>
                            <td>A3</td>
                            <td>a</td>
                            <td>220.00</td>
                            </tr>
                            <tr>
                            <td>56</td>
                            <td>21</td>
                            <td>36</td>
                            <td>G#3/Ab3</td>
                            <td>gis/as</td>
                            <td>207.65</td>
                            </tr>
                            <tr>
                            <td>55</td>
                            <td>20</td>
                            <td>35</td>
                            <td>G3</td>
                            <td>g</td>
                            <td>196.00</td>
                            </tr>
                            <tr>
                            <td>54</td>
                            <td>19</td>
                            <td>34</td>
                            <td>F#3/Gb3</td>
                            <td>fis/ges</td>
                            <td>185.00</td>
                            </tr>
                            <tr>
                            <td>53</td>
                            <td>18</td>
                            <td>33</td>
                            <td>F3</td>
                            <td>f</td>
                            <td>174.61</td>
                            </tr>
                            <tr>
                            <td>52</td>
                            <td>17</td>
                            <td>32</td>
                            <td>E3</td>
                            <td>e</td>
                            <td>164.81</td>
                            </tr>
                            <tr>
                            <td>51</td>
                            <td>16</td>
                            <td>31</td>
                            <td>D#3/Eb3</td>
                            <td>dis/es</td>
                            <td>155.56</td>
                            </tr>
                            <tr>
                            <td>50</td>
                            <td>15</td>
                            <td>30</td>
                            <td>D3</td>
                            <td>d</td>
                            <td>146.83</td>
                            </tr>
                            <tr>
                            <td>49</td>
                            <td>14</td>
                            <td>29</td>
                            <td>C#3/Db3</td>
                            <td>cis/des</td>
                            <td>138.59</td>
                            </tr>
                            <tr>
                            <td>48</td>
                            <td>13</td>
                            <td>28</td>
                            <td>C3</td>
                            <td>c</td>
                            <td>130.81</td>
                            </tr>
                            <tr>
                            <td>47</td>
                            <td>12</td>
                            <td>27</td>
                            <td>B2</td>
                            <td>H</td>
                            <td>123.47</td>
                            </tr>
                            <tr>
                            <td>46</td>
                            <td>11</td>
                            <td>26</td>
                            <td>A#2/Bb2</td>
                            <td>Ais/B</td>
                            <td>116.54</td>
                            </tr>
                            <tr>
                            <td>45</td>
                            <td>10</td>
                            <td>25</td>
                            <td>A2</td>
                            <td>A</td>
                            <td>110.00</td>
                            </tr>
                            <tr>
                            <td>44</td>
                            <td>9</td>
                            <td>24</td>
                            <td>G#2/Ab2</td>
                            <td>Gis/As</td>
                            <td>103.83</td>
                            </tr>
                            <tr>
                            <td>43</td>
                            <td>8</td>
                            <td>23</td>
                            <td>G2</td>
                            <td>G</td>
                            <td>98.00</td>
                            </tr>
                            <tr>
                            <td>42</td>
                            <td>7</td>
                            <td>22</td>
                            <td>F#2/Gb2</td>
                            <td>Fis/Ges</td>
                            <td>92.50</td>
                            </tr>
                            <tr>
                            <td>41</td>
                            <td>6</td>
                            <td>21</td>
                            <td>F2</td>
                            <td>F</td>
                            <td>87.31</td>
                            </tr>
                            <tr>
                            <td>40</td>
                            <td>5</td>
                            <td>20</td>
                            <td>E2</td>
                            <td>E</td>
                            <td>82.41</td>
                            </tr>
                            <tr>
                            <td>39</td>
                            <td>4</td>
                            <td>19</td>
                            <td>D#2/Eb2</td>
                            <td>Dis/Es</td>
                            <td>77.78</td>
                            </tr>
                            <tr>
                            <td>38</td>
                            <td>3</td>
                            <td>18</td>
                            <td>D2</td>
                            <td>D</td>
                            <td>73.42</td>
                            </tr>
                            <tr>
                            <td>37</td>
                            <td>2</td>
                            <td>17</td>
                            <td>C#2/Db2</td>
                            <td>Cis/Des</td>
                            <td>69.30</td>
                            </tr>
                            <tr>
                            <td>36</td>
                            <td>1</td>
                            <td>16</td>
                            <td>C2</td>
                            <td>C</td>
                            <td>65.41</td>
                            </tr>
                            <tr>
                            <td>35</td>
                            <td>&nbsp;</td>
                            <td>15</td>
                            <td>B1</td>
                            <td>H1</td>
                            <td>61.74</td>
                            </tr>
                            <tr>
                            <td>34</td>
                            <td>&nbsp;</td>
                            <td>14</td>
                            <td>A#1/Bb1</td>
                            <td>Ais1/b1</td>
                            <td>58.27</td>
                            </tr>
                            <tr>
                            <td>33</td>
                            <td>&nbsp;</td>
                            <td>13</td>
                            <td>A1</td>
                            <td>A1</td>
                            <td>55.00</td>
                            </tr>
                            <tr>
                            <td>32</td>
                            <td>&nbsp;</td>
                            <td>12</td>
                            <td>G#1/Ab1</td>
                            <td>Gis1/As1</td>
                            <td>51.91</td>
                            </tr>
                            <tr>
                            <td>31</td>
                            <td>&nbsp;</td>
                            <td>11</td>
                            <td>G1</td>
                            <td>G1</td>
                            <td>49.00</td>
                            </tr>
                            <tr>
                            <td>30</td>
                            <td>&nbsp;</td>
                            <td>10</td>
                            <td>F#1/Gb1</td>
                            <td>Fis1/Ges1</td>
                            <td>46.25</td>
                            </tr>
                            <tr>
                            <td>29</td>
                            <td>&nbsp;</td>
                            <td>9</td>
                            <td>F1</td>
                            <td>F1</td>
                            <td>43.65</td>
                            </tr>
                            <tr>
                            <td>28</td>
                            <td>&nbsp;</td>
                            <td>8</td>
                            <td>E1</td>
                            <td>E1</td>
                            <td>41.20</td>
                            </tr>
                            <tr>
                            <td>27</td>
                            <td>&nbsp;</td>
                            <td>7</td>
                            <td>D#1/Eb1</td>
                            <td>Dis1/Es1</td>
                            <td>38.89</td>
                            </tr>
                            <tr>
                            <td>26</td>
                            <td>&nbsp;</td>
                            <td>6</td>
                            <td>D1</td>
                            <td>D1</td>
                            <td>36.71</td>
                            </tr>
                            <tr>
                            <td>25</td>
                            <td>&nbsp;</td>
                            <td>5</td>
                            <td>C#1/Db1</td>
                            <td>Cis1/Des1</td>
                            <td>34.65</td>
                            </tr>
                            <tr>
                            <td>24</td>
                             <td>&nbsp;</td>
                            <td>4</td>
                            <td>C1</td>
                            <td>C1</td>
                            <td>32.70</td>
                            </tr>
                            <tr>
                            <td>23</td>
                            <td>&nbsp;</td>
                            <td>3</td>
                            <td>B0</td>
                            <td>H2</td>
                            <td>30.87</td>
                            </tr>
                            <tr>
                            <td>22</td>
                            <td>&nbsp;</td>
                            <td>2</td>
                            <td>A#0/Bb0</td>
                            <td>Ais2/B2</td>
                            <td>29.14</td>
                            </tr>
                            <tr>
                            <td>21</td>
                            <td>&nbsp;</td>
                            <td>1</td>
                            <td>A0</td>
                            <td>A2</td>
                            <td>27.50</td>
                            </tr>
                            <tr>
                            <td>20</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>25.96</td>
                            </tr>
                            <tr>
                            <td>19</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>24.50</td>
                            </tr>
                            <tr>
                            <td>18</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>23.12</td>
                            </tr>
                            <tr>
                            <td>17</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>21.83</td>
                            </tr>
                            <tr>
                            <td>16</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>20.60</td>
                            </tr>
                            <tr>
                            <td>15</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>19.45</td>
                            </tr>
                            <tr>
                            <td>14</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>18.35</td>
                            </tr>
                            <tr>
                            <td>13</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>17.32</td>
                            </tr>
                            <tr>
                            <td>12</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>16.35</td>
                            </tr>
                            <tr>
                            <td>11</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>15.43</td>
                            </tr>
                            <tr>
                            <td>10</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>14.57</td>
                            </tr>
                            <tr>
                            <td>9</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>13.75</td>
                            </tr>
                            <tr>
                            <td>8</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>12.98</td>
                            </tr>
                            <tr>
                            <td>7</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>12.25</td>
                            </tr>
                            <tr>
                            <td>6</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>11.56</td>
                            </tr>
                            <tr>
                            <td>5</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>10.91</td>
                            </tr>
                            <tr>
                            <td>4</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>10.30</td>
                            </tr>
                            <tr>
                            <td>3</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>9.72</td>
                            </tr>
                            <tr>
                            <td>2</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>9.18</td>
                            </tr>
                            <tr>
                            <td>1</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>8.66</td>
                            </tr>
                            <tr>
                            <td>0</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>8.18</td>
                            </tr>
                            </tbody>
                            </table>
                    <br><hr><br>
                    
                    <h3 id="cad">Cad Design</h3><br>
                    <p>Finished cad design.</p><img src="Assets0/finalpro/cad/finished/1.JPG">
                    <p></p><img src="Assets0/finalpro/cad/finished/2.JPG">
                    <p>Servos are mounted in front.</p><img src="Assets0/finalpro/cad/finished/3.JPG">
                    <p>Servos line up with keys.</p><img src="Assets0/finalpro/cad/finished/4.JPG">
                    <p>Slots constraint the linkages.</p><img src="Assets0/finalpro/cad/finished/5.JPG">
                    <p>LCD, SD card and the rotary encoder will be here.</p><img src="Assets0/finalpro/cad/finished/6.JPG">
                    <p>Back view. The hole on the right was originally intended for a sever fan to supply the air pressure to play the melodica. It was not powerfull enough.</p><img src="Assets0/finalpro/cad/finished/7.JPG">
                    <p>Servos are mounted in foam to absorb vibrations.</p><img src="Assets0/finalpro/cad/finished/8.JPG">
                    <br><hr><br>
                    <h3 id="moldncast">Molding and casting</h3><br>
                        <h4 id="mill">CNC milling</h4>
                        <p>Milling has started.</p><img src="Assets0/finalpro/cast/cnc/1.jpg">
                        <p>Toolpath.</p><img src="Assets0/finalpro/cast/cnc/2.jpg">
                        <p>Pocketing has begun.</p><img src="Assets0/finalpro/cast/cnc/3.jpg">
                        <p>Finishing passes.</p><img src="Assets0/finalpro/cast/cnc/4.jpg">
                        <p>Milling is done.</p><img src="Assets0/finalpro/cast/cnc/5.jpg">
                        <p>Close up of finished mold.</p><img src="Assets0/finalpro/cast/cnc/6.jpg">
                        <p>CNC milling underway.</p><video autoplay muted loop width=100%><source src="Assets0/finalpro/cast/cnc/v.mp4" type="video/mp4"></video>
                    
                    <br><hr><br>
                        <h4 id="mold">Molding</h4>
                        <p>Silicone is poured in at an angle.</p><img src="Assets0/finalpro/cast/mold/1.jpg">
                        <p>Silicone pour is done.</p><img src="Assets0/finalpro/cast/mold/2.jpg">
                        <p>Foam is broken off.</p><img src="Assets0/finalpro/cast/mold/3.jpg">
                        <p></p><img src="Assets0/finalpro/cast/mold/4.jpg">
                        <p>Finished mold.</p><img src="Assets0/finalpro/cast/mold/5.jpg">
                    <br><hr><br>
                        <h4 id="cast">Casting</h4>
                        <p>Polyurathane is poured into the mold.</p><img src="Assets0/finalpro/cast/cast/1.jpg">
                        <p>There are some overflows and spills.</p><img src="Assets0/finalpro/cast/cast/15.jpg">
                        <p>Once hard enough they can be cut off with a knife.</p><img src="Assets0/finalpro/cast/cast/2.jpg">
                        <p>Heat makes the polyurathane cure faster.</p><img src="Assets0/finalpro/cast/cast/3.jpg">
                        <p>The mold is bent to demold the parts.</p><img src="Assets0/finalpro/cast/cast/4.jpg">
                        <p>Parts are pushed out of the mold.</p><img src="Assets0/finalpro/cast/cast/5.jpg">
                        <p>Cast parts.</p><img src="Assets0/finalpro/cast/cast/6.jpg">
                        <p>Some parts did not reach the bottom of the mold.</p><img src="Assets0/finalpro/cast/cast/7.jpg">
                        <p>One batch was not mixed well. The polyurathane did not set even after a day.</p><img src="Assets0/finalpro/cast/cast/8.jpg">
                        <p>Holes are drilled into the ends.</p><img src="Assets0/finalpro/cast/cast/9.jpg">
                        <p>Finished part with hole.</p><img src="Assets0/finalpro/cast/cast/10.jpg">
                    <br><hr><br>
                    
                    <h3 id="cncm">CNC milling</h3><br>
                    <p>First attempt milling.</p><img src="Assets0/finalpro/cnc/3.jpg">
                    <p>Facing the back.</p><img src="Assets0/finalpro/cnc/1.jpg">
                    <p>Milling is done.</p><img src="Assets0/finalpro/cnc/2.jpg">
                    <p>The first attempt has an inconsistent height because of the second side facing. The second attempt only has operations on one side.</p>
                    <p>Second attempt at milling left side.</p><img src="Assets0/finalpro/cnc/4.jpg">
                    <p>Right side milling.</p><img src="Assets0/finalpro/cnc/5.jpg">
                    <br><hr><br>
                    
                    <h3 id="3dp">3D printing</h3><br>
                    <p>3D printing of standoffs.</p><img src="Assets0/finalpro/3dp/1.jpg">
                    <p>3D printing is done.</p><img src="Assets0/finalpro/3dp/2.jpg">
                    <p>Printing in progress.</p><video autoplay muted loop width=100%><source src="Assets0/finalpro/3dp/3.mp4" type="video/mp4"></video>
                    <p>Another 3d printed part, holddown clamps for the melodica.</p><img src="Assets0/finalpro/3dp/4.jpg">
                    <br><hr><br>
                    
                    <h3 id="laser">Laser cutting</h3><br>
                    <p></p><video autoplay muted loop width=100%><source src="Assets0/finalpro/laser/1.mp4" type="video/mp4"></video>
                    <p></p><img src="Assets0/finalpro/laser/IMG_20220203_161010.jpg">
                    <p></p><video autoplay muted loop width=100%><source src="Assets0/finalpro/laser/2.mp4" type="video/mp4"></video>
                    <br><hr><br>
                    
                    <h3 id="pcbd">Pcb design</h3><br>
                    <p>This section documents printed circuit board design in kicad and milling.</p>
                        <h4 id="srd">Shift register board design</h4><br>
                        <p>Shift registers convert serial data to parrallel data. Up to 40 outputs(5 shift registers) can be driven using only 5 pins.</p><br>
                        <p>This is the Kicad schematic design.</p><img src="Assets0/finalpro/pcb/sr/kicad/1.JPG">
                        <p>PCB design in Kicad.</p><img src="Assets0/finalpro/pcb/sr/kicad/2.JPG">
                        <p>Front side PCB view.</p><img src="Assets0/finalpro/pcb/sr/kicad/3.JPG">
                        <p>Back side PCB view.</p><img src="Assets0/finalpro/pcb/sr/kicad/4.JPG">
                        <p>Front copper toolpath in Flatcam.</p><img src="Assets0/finalpro/pcb/sr/kicad/5.JPG">
                        <p>Back copper toolpath in Flatcam.</p><img src="Assets0/finalpro/pcb/sr/kicad/6.JPG">
                        <br><hr><br>
                        <h4 id="mcud">Microcontroller board design</h4><br>
                        <p>This is the microcontroller schematic.</p><img src="Assets0/finalpro/pcb/mcu/kicad/1.JPG">
                        <p>This is the PCB design in kicad.</p><img src="Assets0/finalpro/pcb/mcu/kicad/2.JPG">
                        <p>PCB 3d view in kicad.</p><img src="Assets0/finalpro/pcb/mcu/kicad/3.JPG">
                        <p>Toolpaths in Flatcam.</p><img src="Assets0/finalpro/pcb/mcu/kicad/4.JPG">
                        <br><hr><br>
                        <h4 id="srm">Shift register board milling</h4><br>
                        <p>Milling has started for the shift register board.</p><img src="Assets0/finalpro/pcb/sr/1.jpg">
                        <p>The back copper is isolation milled.</p><img src="Assets0/finalpro/pcb/sr/2.jpg">
                        <p>Excess copper is being removed.</p><img src="Assets0/finalpro/pcb/sr/3.jpg">
                        <p>Front copper milling is started.</p><img src="Assets0/finalpro/pcb/sr/4.jpg">
                        <p>Milling continues...</p><img src="Assets0/finalpro/pcb/sr/5.jpg">
                        <p>Isolation milling is done.</p><img src="Assets0/finalpro/pcb/sr/6.jpg">
                        <p>The holes are milled.</p><img src="Assets0/finalpro/pcb/sr/7.jpg">
                        <p>Finished holes.</p><img src="Assets0/finalpro/pcb/sr/8.jpg">
                        <p>Finished front copper board.</p><img src="Assets0/finalpro/pcb/sr/9.jpg">
                        <p>Two finished sides of the PCB.</p><img src="Assets0/finalpro/pcb/sr/10.jpg">
                        <p>Shift registers are soldered on.</p><img src="Assets0/finalpro/pcb/sr/11.jpg">
                        <p>Pcb is populated.</p><img src="Assets0/finalpro/pcb/sr/12.jpg">
                        <p>Pin headers are solder on.</p><img src="Assets0/finalpro/pcb/sr/13.jpg">
                        <p>Back copper view.</p><img src="Assets0/finalpro/pcb/sr/14.jpg">
                        <br><hr><br>
                        <h4 id="mcum">Microcontroller board milling</h4><br>
                        <p>Milling for the microcontoller board has started.</p><img src="Assets0/finalpro/pcb/mcu/1.jpg">
                        <p>Toolpath of microcontroller board.</p><img src="Assets0/finalpro/pcb/mcu/6.jpg">
                        <p>FR4 is used for this PCB. Water is used to prevent fiberglass dust from getting into the air and makes the cut smoother.</p><img src="Assets0/finalpro/pcb/mcu/2.jpg">
                        <p>Dust generated is trapped in the water.</p><img src="Assets0/finalpro/pcb/mcu/3.jpg">
                        <p>Video of PCB milling.</p><video autoplay muted loop width=100%><source src="Assets0/finalpro/pcb/mcu/4.mp4" type="video/mp4"></video>
                        <p>The PCB is milled, board outline and holes are cut.</p><img src="Assets0/finalpro/pcb/mcu/5.jpg">
                        <p>Finishd PCB.</p><img src="Assets0/finalpro/pcb/mcu/7.jpg">
                        <p>One part did not cut through.</p><img src="Assets0/finalpro/pcb/mcu/8.jpg">
                        <p>This was fixed with a penknife.</p><img src="Assets0/finalpro/pcb/mcu/9.jpg">
                        <p>Some copper was removed near the atmega chip.</p><img src="Assets0/finalpro/pcb/mcu/10.jpg">
                        <p>Finished, wired microcontroller board.</p><img src="Assets0/finalpro/pcb/mcu/11.jpg">
                        <p>Soldered microcontroller.</p><img src="Assets0/finalpro/pcb/mcu/12.jpg">
                        <br><hr><br>
                    <br><hr><br>
                    
                    <h3 id="prgm">Programming</h3><br>
                        <p>The LCD and rotary encoder ate wired up.</p><img src="Assets0/finalpro/Project/wiring.jpg">
                        <h4 id="renc">Rotory encoder programming</h4><br>
                        <p>The rotary encoder used is a pulse rotary encoder. The clock pulse is polled by the microcontroller when needed. Turning the rotary encoder scrolls the selection menu and clicking the rotary encoder selects the midi track.</p>
                        <p>Program to read rotary encoder.</p><img src="Assets0/finalpro/programming/enc/1.JPG">
                        <p>Endoder count printed on serial monitor.</p><video autoplay muted loop width=100%><source src="Assets0/finalpro/Project/enc.mp4" type="video/mp4"></video>
                    <br><hr><br>
                        <h4 id="lcd">LCD programming</h4><br>
                        <p>The LCD used is a 20x4 LCD. It communicates with the m328 through a 4 bit parallel interface.</p>
                        <p>Modified example program.</p><img src="Assets0/finalpro/programming/lcd/1.JPG">
                        <p>LCD hello world.</p><video autoplay muted loop width=100%><source src="Assets0/finalpro/Project/lcd.mp4" type="video/mp4"></video>
                    <br><hr><br>
                        <h4 id="sd">SD card programming</h4><br>
                        <p>FatFs is used to communicate with the SD card. Fatfs is used because it can use file names longer than 8.5 characters. Limiting the file name lengths to 8 chars and a file extension made long file names hard to read. The fat FS library is used to buffer the data from the SD card in 512 byte blocks.</p>
                        <p>Code to read SD card data.</p><img src="Assets0/finalpro/programming/sd/1.JPG">
                    <br><hr><br>
                        <h4 id="menunav">Menu navigation</h4><br>
                        <p>Code for menu navigation.</p><img src="Assets0/finalpro/programming/menu/1.JPG">
                        <p>Menu displayed on LCD.</p><img src="Assets0/finalpro/Project/menu.jpg">
                        <p>Menu navigation.</p><video autoplay muted loop width=100%><source src="Assets0/finalpro/programming/menu/menunav.mp4" type="video/mp4"></video>
                    <br><hr><br>
                        <h4 id="mdmidi">Midi file processing</h4><br>
                        <p>MD_midi library is used to buffer the midi data read from the SD card. The midi used is standard midi file type 0. The type 0 midi file only has 1 track and all channel events are on that one track, making it easier to read the midi file as all the data is in a continuous ckunk. Md_midi also generates clock timings using timer 0. The clock timings is determined using the rate of the music. MD_midi generates the midi events at the right time and sends the midi data through UART at a baud rate of 19200 to the other two microcontrollers.</p>
                        <p>Code for midi callback.</p><img src="Assets0/finalpro/programming/mdmidi/1.JPG">
                    <br><hr><br>
                        <h4 id="asmsynth">Assembly triangle wave generator</h4><br>
                        <p>The ask synth library is used. It generates a polyphonic tone using triangle waves. Timer 2 is used with a prescaller of 4 to generate a interrupt at 15.6 khz. The microcontroller is programmed for up to 16 tones. Ask synth uses assembly and is programmed for the atmega328p. A speaker is used to generate the notes that could not be played by the melodica. Midi supports 128 notes and all notes can be played by the speaker. A l289 motor driver is used to drive the speaker. A second microcontroller is used because there was not enough memory and the microcontroller would reset itself.</p>
                        <p>Test code.</p><img src="Assets0/finalpro/programming/asmsynth/1.JPG">
                        <p>Assembly source code.</p><img src="Assets0/finalpro/programming/asmsynth/2.JPG">
                        <p>Configurations needed to be set before compile.</p><img src="Assets0/finalpro/programming/asmsynth/3.JPG">
                        <p>Example waveform generated by asmsynth. Source:Sezam</p><img src="Assets0/finalpro/programming/asmsynth/4.JPG">
                        <p>Example sketch.</p><video controls width=100%><source src="Assets0/finalpro/Project/tetrisAsmsynthTest.mp4" type="video/mp4"></video>
                    <br><hr><br>
                        <h4 id="uart">UART buffering</h4><br>
                        <p>The standard uart buffer of 64 bytes is not enough because the program is not fast enough to read the buffer before it is full.</p>
                        <p>The standard uart buffer size is 64.</p><img src="Assets0/finalpro/programming/uart/1.JPG">
                        <p>Recieve buffer size is increades to 256 and transmit is reduced to 16.</p><img src="Assets0/finalpro/programming/uart/1.JPG">
                    <br><hr><br>
                        <h4 id="adsr">ADSR envelope</h4><br>
                        <p>An adsr envelope is used to make the notes sound more realistic. The adsr envelope use timer 0 for the clock.</p>
                        <p></p><img src="Assets0/finalpro/programming/adsr.jpg">
                    <br><hr><br>
                        <h4 id="sr">Shift register programming</h4><br>
                        <p>The shift register is used as the atmega328 dose not have enough pins to control 37 servos at once. The shift register converte serial data to parrallel data.</p>
                        <p>digitalWriteFast is a macro that compiles into a single assembly instrucion.</p><img src="Assets0/finalpro/programming/sr/1.JPG">
                        <p>Shift register test with LEDs.</p><video autoplay muted loop width=100%><source src="Assets0/finalpro/programming/shiftreg.mp4" type="video/mp4"></video>
                    <br><hr><br>
                        <h4 id="tmr1">Servo timer interrupts</h4><br>
                        <p>The third microcontroller controls the servo motors. Timer 1 compare and overflow interrupts are used to generate a pulse for the servo motor. The melodica only cover notes 35 hex to 59 hex. There is a 5 A poly fuse to limit the current into the servos so that in case too many servos move at once, it would not draw too much current. This polyfuse has been accidentaly tested and verified to be working. A third microcontroller was used because the second microcontroller uses too many of it cycles inside that timer 2 interrupt vector. There are only 1024 cycles between timer 2 interrupts and it was not enough. The timer 2 interrupt took too many cycles and caused the servo timings generated by timer 1 to be inconsistent. The srevos draw the most current. A 12v 3 a wall adaptor is used to supply the power. It goes through a 5v 5a buck convertor that supplies the microcontrollers and servos.</p>
                        <p>Timer 1 interrupts are used to drive the servos.</p><img src="Assets0/finalpro/programming/sr/2.JPG">
                        <p>Timer 1 setup.</p><img src="Assets0/finalpro/programming/sr/3.JPG">
                        <p>Servo test.</p><video autoplay muted loop width=100%><source src="Assets0/finalpro/programming/servo.mp4" type="video/mp4"></video>
                        <p>Servo test 2.</p><video autoplay muted loop width=100%><source src="Assets0/finalpro/Finished/servotnorod.mp4" type="video/mp4"></video>
                    <br><hr><br>
                        <h4 id="bootl">Bootloader burn</h4><br>
                        <p>A bootloader is needed to program the atmega328 chip using uart. The standard programming via ISP does not. Fuses need to be set for the external crystal.</p>
                        <p>The chip is first tested with AVRdude.</p><img src="Assets0/finalpro/programming/bootloader/avrdude.JPG">
                        <p>Minicore is used because the standard arduino core dosent include the atmega328 chip.</p><img src="Assets0/finalpro/programming/bootloader/minicore.JPG">
                        <p>The fuses and bootloader are burnt.</p><img src="Assets0/finalpro/programming/bootloader/bootloaderburn.JPG">
                    <br><hr><br>
                        <h4 id="src">Source files</h4><br>
                        <p>All source files including test code.</p>
                        <a href="Assets0/finalpro/programming/src.zip" download >Download.</a>
                    <br><hr><br>
                    
                    <br><hr><br>
                    <h3 id="slide">Slide</h3><br>
                    <p></p><img src="Assets0/finalpro/Presentation.png">
                    <br><hr><br>
                    
                    <h3 id="video">Project video</h3><br>
                    <iframe width=100% height=760px src="https://www.youtube.com/embed/0BFM0Zm7V5g" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><br><hr><br>
                    <h4>Full test</h4>
                    <iframe width=100% height=760px src="https://www.youtube.com/embed/GlcismlSbuo" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><br><hr><br>
                    
                    <br><hr><br>
                    <h3 id="test">Testing</h3><br>
                    <table>
                      <tr>
                        <th>Volume</th>
                        <th>Midi Track</th>
                        <th>Test result</th>
                      </tr>
                      <tr>
                        <td>Minecraft Volume Alpha</td>
                        <td>Calm</td>
                        <td>Good</td>
                      </tr>
                      <tr>
                        <td></td>
                        <td>Key</td>
                        <td>Good</td>
                      </tr>
                      <tr>
                        <td></td>
                        <td>Living Mice</td>
                        <td>Missed notes</td>
                      </tr>
                      <tr>
                        <td></td>
                        <td>Sweden</td>
                        <td>Stuck notes</td>
                      </tr>
                      <tr>
                        <td>Minecraft Volume Beta</td>
                        <td>Mall</td>
                        <td>Stuck notes</td>
                      </tr>
                      <tr>
                        <td></td>
                        <td>Mellohi</td>
                        <td>Good</td>
                      </tr>
                      <tr>
                        <td></td>
                        <td>Wait</td>
                        <td>Good</td>
                      </tr>
                      <tr>
                        <td>Undertale</td>
                        <td>Home</td>
                        <td>Good</td>
                      </tr>
                      <tr>
                        <td></td>
                        <td>Once Upon A Time</td>
                        <td>Good</td>
                      </tr>
                      <tr>
                        <td></td>
                        <td>Undertale</td>
                        <td>Stuck notes</td>
                      </tr>
                        <tr>
                        <td>Misc</td>
                        <td>Hello World</td>
                        <td>Stuck notes</td>
                      </tr>
                      <tr>
                        <td></td>
                        <td>Eight Melodies</td>
                        <td>Good</td>
                      </tr>
                    </table>
                    <h4 id="mcAlpha">Minecraft Volume Alpha</h4><br>
                    <h5 id="calm">Calm</h5>
                    <audio controls>
                      <source src="Assets0/finalpro/Rec/mcAlpha/calm.wav" type="audio/ogg">
                    </audio><br><br>
                    <h5 id="key">Key</h5>
                    <audio controls>
                      <source src="Assets0/finalpro/Rec/mcAlpha/key.wav" type="audio/ogg">
                    </audio><br><br>
                    <h5 id="living_mice">Living Mice</h5>
                    <audio controls>
                      <source src="Assets0/finalpro/Rec/mcAlpha/living%20mice.wav" type="audio/ogg">
                    </audio><br><br>
                    <h5 id="sweden">Sweden</h5>
                    <audio controls>
                      <source src="Assets0/finalpro/Rec/mcAlpha/sweden.wav" type="audio/ogg">
                    </audio><br><br>
                    
                    <h4 id="mcBeta">Minecraft Volume Beta</h4><br>
                    <h5 id="mall">Mall</h5>
                    <audio controls>
                      <source src="Assets0/finalpro/Rec/mcBeta/mall.wav" type="audio/ogg">
                    </audio><br><br>
                    <h5 id="mellohi">Mellohi</h5>
                    <audio controls>
                      <source src="Assets0/finalpro/Rec/mcBeta/mellohi.wav" type="audio/ogg">
                    </audio><br><br>
                    <h5 id="wait">Wait</h5>
                    <audio controls>
                      <source src="Assets0/finalpro/Rec/mcBeta/wait.wav" type="audio/ogg">
                    </audio><br><br>
                    
                    <h4 id="undertale">Undertale</h4><br>
                    <h5 id="home">Home</h5>
                    <audio controls>
                      <source src="Assets0/finalpro/Rec/undertale/home.wav" type="audio/ogg">
                    </audio><br><br>
                    <h5 id="ouat">Once Upon A Time</h5>
                    <audio controls>
                      <source src="Assets0/finalpro/Rec/undertale/onceUponAtime.wav" type="audio/ogg">
                    </audio><br><br>
                    <h5 id="undertaleUndertale">Undertale</h5>
                    <audio controls>
                      <source src="Assets0/finalpro/Rec/undertale/undertale.wav" type="audio/ogg">
                    </audio><br><br>
                    
                    <h4 id="hello_world">Hello World</h4><br>
                    <audio controls>
                      <source src="Assets0/finalpro/Rec/helloworld.wav" type="audio/ogg">
                    </audio><br><br>
                    
                    <h4 id="eight_melodies">Eight melodies</h4><br>
                    <audio controls>
                      <source src="Assets0/finalpro/Rec/eightmelodies.wav" type="audio/ogg">
                    </audio><br><br>
                    
                    
                    
                    <br><hr><br>
                    <h3 id="FIN">Finished</h3><br>
                    <p>Wires bundled and tied. Boards mounted with 3d printed mounts.</p><img src="Assets0/finalpro/Finished/1.jpg">
                    <p></p><img src="Assets0/finalpro/Finished/2.jpg">
                    <p>A foot pump is used to supply air pressure. Initially a server fan was used, but it was not powerful enough and was too loud.</p><img src="Assets0/finalpro/Finished/pump.jpg">
                    <p>Balloon to smooth out air pressure.</p><img src="Assets0/finalpro/Finished/res.jpg">
                    <p>Servo pressing keys.</p><video autoplay muted loop width=100%><source src="Assets0/finalpro/Finished/pulltest.mp4" type="video/mp4"></video>
                    <br><hr><br>
                    <p>Its Done!</p><img src="Assets0/finalpro/Finished/3.jpg">
                    <p></p><img src="Assets0/finalpro/Finished/4.jpg">
                    <p></p><img src="Assets0/finalpro/Finished/5.jpg">
                    <p></p><img src="Assets0/finalpro/Finished/6.jpg">
                    <p></p><img src="Assets0/finalpro/Finished/7.jpg">
                    <p></p><img src="Assets0/finalpro/Finished/8.jpg">
                    <p></p><img src="Assets0/finalpro/Finished/9.jpg">
                    <p></p><img src="Assets0/finalpro/Finished/10.jpg">
                    
                    
                    <p>That's all folks!</p>
                    
                </div>
            </div>
        <footer id="footer">
            copyright &copy; 2022 Yew Zi Hon
        
        </footer>
        </div>
	</body>
</html>